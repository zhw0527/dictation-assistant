<!--pages/dictation/dictation.wxml-->
<view class="container">
  <!-- ç§¯åˆ†æ˜¾ç¤ºåŒºåŸŸ -->
  <view class="points-display" wx:if="{{isStarted}}">
    <view class="total-points">
      <text class="points-label">æ€»ç§¯åˆ†</text>
      <text class="points-value">{{totalPoints}}</text>
    </view>
    <view class="session-points">
      <text class="session-label">æœ¬æ¬¡</text>
      <text class="session-value">+{{sessionPoints}}</text>
    </view>
    <view class="streak-display" wx:if="{{streak > 0}}">
      <text class="streak-icon">ğŸ”¥</text>
      <text class="streak-value">{{streak}} è¿å‡»</text>
    </view>
  </view>

  <!-- è¯æ±‡æ˜¾ç¤ºåŒºåŸŸ -->
  <view class="word-display {{answerAnimation}}">
    <text class="current-word">{{currentWord || 'å‡†å¤‡å¼€å§‹'}}</text>
    <text class="word-index">{{currentIndex + 1}} / {{wordList.length}}</text>
  </view>

  <!-- è¾“å…¥åŒºåŸŸ -->
  <view class="input-area">
    <input 
      class="word-input" 
      placeholder="è¯·è¾“å…¥å¬åˆ°çš„å†…å®¹"
      value="{{userInput}}"
      bindinput="onInput"
      disabled="{{!isStarted}}"
    />
  </view>

  <!-- è¯­éŸ³è¾“å…¥æŒ‰é’® -->
  <view class="voice-input" wx:if="{{isStarted}}">
    <button 
      class="btn-record {{isRecording ? 'recording' : ''}}" 
      bindtouchstart="startRecord"
      bindtouchend="stopRecord"
    >
      <text class="record-icon">{{isRecording ? 'ğŸ¤' : 'ğŸ™ï¸'}}</text>
      <text class="record-text">{{isRecording ? 'å½•éŸ³ä¸­...' : 'æŒ‰ä½è¯´è¯'}}</text>
    </button>
  </view>

  <!-- æ§åˆ¶æŒ‰é’® -->
  <view class="control-buttons">
    <button class="btn-control" bindtap="playWord" wx:if="{{isStarted}}">
      ğŸ”Š æ’­æ”¾
    </button>
    <button class="btn-control" bindtap="takePhoto" wx:if="{{isStarted}}">
      ğŸ“· æ‹ç…§æ‰¹æ”¹
    </button>
    <button class="btn-control btn-primary" bindtap="nextWord" wx:if="{{isStarted}}">
      ä¸‹ä¸€ä¸ª
    </button>
    <button class="btn-control btn-primary" bindtap="startDictation" wx:if="{{!isStarted}}">
      å¼€å§‹å¬å†™
    </button>
    <button class="btn-control" bindtap="finishDictation" wx:if="{{isStarted}}">
      å®Œæˆ
    </button>
  </view>

  <!-- è¿›åº¦æ¡ -->
  <view class="progress-bar">
    <view class="progress" style="width: {{progress}}%"></view>
  </view>
</view>
